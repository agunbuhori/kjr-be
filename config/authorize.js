const BEARER = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7IlVzZXIiOnsiaWQiOiI5ZjU3NGY3NS1hMzEwLTRmM2MtYTY5OC03N2Q3MTYxYmEyZjMiLCJuaWNrbmFtZSI6ImNhbG1hbnRhcmEiLCJhY2NvdW50X3R5cGUiOiJJTlRFUk5BTCIsIm5hbWUiOiJjYWxtYW50YXJhIiwiZW1haWwiOiJjYWxtYW50YXJhc3BAZ21haWwuY29tIiwicm9sZSI6IkFETUlOIiwicmVjb3JkX2ZsYWciOiJBQ1RJVkUifSwiUmVmcmVzaFRva2VuSUQiOiJhN2UzNGI4Ny1jODNkLTQyMTctOWJhZS1kNTBiZGM5Mzg3ZWIiLCJQcm92aWRlciI6Im1pbmR0ZXJhIiwiQXV0aFRva2VuIjoiIiwiUmVmcmVzaFRva2VuIjoiZXlKaGJHY2lPaUpJVXpJMU5pSXNJblI1Y0NJNklrcFhWQ0o5LmV5SmtZWFJoSWpwN0lrbEVJam9pWVRkbE16UmlPRGN0WXpnelpDMDBNakUzTFRsaVlXVXRaRFV3WW1Sak9UTTROMlZpSWl3aVZYTmxja2xFSWpvaU9XWTFOelJtTnpVdFlUTXhNQzAwWmpOakxXRTJPVGd0Tnpka056RTJNV0poTW1Zeklpd2lVSEp2ZG1sa1pYSWlPaUp0YVc1a2RHVnlZU0lzSWtWNGNHbHlaWE5CZENJNk56SXdNSDBzSW1WNGNDSTZNVFl6TnpZeE9UZzJNQ3dpYVdGMElqb3hOak0zTmpFeU5qWXdMQ0pwYzNNaU9pSmtZWE5vWW05aGNtUXRZWFYwYUNKOS5qendKY3lTRTMydlR5eWpBbElhZmhsZ0M2T3dMU3U1V1NwLXZuc2NQcTRJIiwiVXNlclNlc3Npb25JRCI6IiIsIlVzZXJMb2dBY3Rpdml0eUlEIjoiIiwiRXhwaXJlc0F0IjozNjAwfSwiZXhwIjoxNjM3NjE2MjYwLCJpYXQiOjE2Mzc2MTI2NjAsImlzcyI6ImRhc2hib2FyZC1hdXRoIn0.Y2UrbIPAVxARrP8nMX-cGMUgR67XQ2j5MNqoeF7dHVA";

function authorize(req, res, next) {
  if (req.headers.authorization === 'Bearer '.concat(BEARER)) {
    next();
  } else {
    res.status(403).send({
      status: 403,
      message: "Unauthorized"
    });
  }
}

module.exports = authorize